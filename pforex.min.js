var Q=function(e){return document.querySelectorAll(e)};Pforex={base:"USD",current:"EUR",init:function(){this.mkSelector();var e=function(e,r){if(Cookies.get("pforex")!==undefined){Pforex.set(Cookies.get("pforex"))}else{Pforex.set("USD")}Pforex.update();Pforex.watch()};this.data(e,e)},watch:function(){var e=this;var r=new MutationObserver(function(r){r.forEach(function(r){e.render(r.target)})});var t=function(e){r.observe(e,{attributes:true})};Q("[data-pforex-price]").forEach(t);Q("pforex").forEach(t)},render:function(e){var r=Pforex;var t=parseInt(e.getAttribute("price")||e.getAttribute("data-pforex-price"));t=t*r.rates[r.base]/r.rates[r.current];var o=r.currencies[r.current].decimals;t=Math.round(t/100*Math.pow(10,o))/Math.pow(10,o);t=r.separate(t,r.currencies[r.current].separator);var n=r.currencies[r.current].symbol+t;if((e.attributes["showcurrency"]||e.attributes["data-pforex-showcurrency"])!==undefined){n=n+" "+Pforex.current}var a=e.getAttribute("re")||e.getAttribute("data-pforex-re");if(e.innerHTML.length===0||a===null){e.innerHTML=n}else{var c=e.innerHTML;var i=RegExp(a,"g");var u=i.exec(c);while(u!==null&&u.length>1){c=c.replace(u[1],n);u=i.exec(c)}e.innerHTML=c}},update:function(){Q("pforex").forEach(Pforex.render);Q("[data-pforex-price]").forEach(Pforex.render);Q("select[pforex-selector]").forEach(function(e){e.value=Pforex.current})},mkSelector:function(){Q("select[pforex-selector]").forEach(function(e){e.onchange=function(e){Pforex.set(e.target.value)}})},set:function(e){if(Pforex.currencies[e]!==undefined){Pforex.current=e}else{console.log("Attempting to set unknown currency:",e)}Cookies.set("pforex",Pforex.current);Pforex.update()},get:function(){return Pforex.current},data:function(cb,err){var xhr=new XMLHttpRequest;xhr.open("GET","//cdn.shopify.com/s/javascripts/currencies.js");xhr.onload=function(){if(xhr.status===200){eval(xhr.responseText);Pforex.rates=Currency.rates;return cb?cb():false}else{console.log("Pforex could not load currency data:",xhr);return err?err():false}};xhr.send()},separate:function(e,r){function t(e){var t=e.toString().split(".");t[0]=t[0].replace(/\B(?=(\d{3})+(?!\d))/g,r);return t.join(".")}return t(e)},currencies:{USD:{symbol:"$",decimals:2,separator:","},CAD:{symbol:"$",decimals:2,separator:","},AUD:{symbol:"$",decimals:2,separator:","},EUR:{symbol:"&euro;",decimals:2,separator:","},JPY:{symbol:"&#165;",decimals:0,separator:","},GBP:{symbol:"&pound;",decimals:2,separator:","}}};(function(e,r){"use strict";var t=function(e){if(typeof e.document!=="object"){throw new Error("Cookies.js requires a `window` with a `document` object")}var t=function(e,r,o){return arguments.length===1?t.get(e):t.set(e,r,o)};t._document=e.document;t._cacheKeyPrefix="cookey.";t._maxExpireDate=new Date("Fri, 31 Dec 9999 23:59:59 UTC");t.defaults={path:"/",secure:false};t.get=function(e){if(t._cachedDocumentCookie!==t._document.cookie){t._renewCache()}var o=t._cache[t._cacheKeyPrefix+e];return o===r?r:decodeURIComponent(o)};t.set=function(e,o,n){n=t._getExtendedOptions(n);n.expires=t._getExpiresDate(o===r?-1:n.expires);t._document.cookie=t._generateCookieString(e,o,n);return t};t.expire=function(e,o){return t.set(e,r,o)};t._getExtendedOptions=function(e){return{path:e&&e.path||t.defaults.path,domain:e&&e.domain||t.defaults.domain,expires:e&&e.expires||t.defaults.expires,secure:e&&e.secure!==r?e.secure:t.defaults.secure}};t._isValidDate=function(e){return Object.prototype.toString.call(e)==="[object Date]"&&!isNaN(e.getTime())};t._getExpiresDate=function(e,r){r=r||new Date;if(typeof e==="number"){e=e===Infinity?t._maxExpireDate:new Date(r.getTime()+e*1e3)}else if(typeof e==="string"){e=new Date(e)}if(e&&!t._isValidDate(e)){throw new Error("`expires` parameter cannot be converted to a valid Date instance")}return e};t._generateCookieString=function(e,r,t){e=e.replace(/[^#$&+\^`|]/g,encodeURIComponent);e=e.replace(/\(/g,"%28").replace(/\)/g,"%29");r=(r+"").replace(/[^!#$&-+\--:<-\[\]-~]/g,encodeURIComponent);t=t||{};var o=e+"="+r;o+=t.path?";path="+t.path:"";o+=t.domain?";domain="+t.domain:"";o+=t.expires?";expires="+t.expires.toUTCString():"";o+=t.secure?";secure":"";return o};t._getCacheFromString=function(e){var o={};var n=e?e.split("; "):[];for(var a=0;a<n.length;a++){var c=t._getKeyValuePairFromCookieString(n[a]);if(o[t._cacheKeyPrefix+c.key]===r){o[t._cacheKeyPrefix+c.key]=c.value}}return o};t._getKeyValuePairFromCookieString=function(e){var r=e.indexOf("=");r=r<0?e.length:r;var t=e.substr(0,r);var o;try{o=decodeURIComponent(t)}catch(e){if(console&&typeof console.error==="function"){console.error('Could not decode cookie with key "'+t+'"',e)}}return{key:o,value:e.substr(r+1)}};t._renewCache=function(){t._cache=t._getCacheFromString(t._document.cookie);t._cachedDocumentCookie=t._document.cookie};t._areEnabled=function(){var e="cookies.js";var r=t.set(e,1).get(e)==="1";t.expire(e);return r};t.enabled=t._areEnabled();return t};var o=e&&typeof e.document==="object"?t(e):t;if(typeof define==="function"&&define.amd){define(function(){return o})}else if(typeof exports==="object"){if(typeof module==="object"&&typeof module.exports==="object"){exports=module.exports=o}exports.Cookies=o}else{e.Cookies=o}})(typeof window==="undefined"?this:window);Pforex.init();
