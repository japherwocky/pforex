var Q=function(e){return document.querySelectorAll(e)};Pforex={base:"USD",current:"EUR",version:"0.2",init:function(){this.mkSelector();var e=function(e,t){if(Cookies.get("pforex")!==undefined){Pforex.set(Cookies.get("pforex"))}else{Pforex.set("USD")}Pforex.update();Pforex.watch()};this.data(e,e)},watch:function(){var e=this;var t=new MutationObserver(function(t){t.forEach(function(t){e.render(t.target)})});var r=function(e){t.observe(e,{attributes:true})};Q("[data-pforex-price]").forEach(r);Q("pforex").forEach(r)},render:function(e){var t=Pforex;var r=parseInt(e.getAttribute("price")||e.getAttribute("data-pforex-price"));r=r*t.rates[t.base]/t.rates[t.current];var o=t.currencies[t.current].decimals;r=Math.round(r/100*Math.pow(10,o))/Math.pow(10,o);r=t.separate(r,t.currencies[t.current]);var n="";if((e.getAttribute("show-symbol")||e.getAttribute("data-pforex-show-symbol"))!=="false"){n=n+t.currencies[t.current].symbol}if(r!=="NaN"){console.log("out",n,r);n=n+r}if((e.getAttribute("show-currency")||e.getAttribute("data-pforex-show-currency"))==="true"){if(n.length>=0){n=n+" "+Pforex.current}else{n=Pforex.current}}var a=e.getAttribute("re")||e.getAttribute("data-pforex-re");if(e.innerHTML.length===0||a===null){e.innerHTML=n}else{var c=e.innerHTML;var i=RegExp(a,"g");var s=i.exec(c);while(s!==null&&s.length>1){c=c.replace(s[1],n);s=i.exec(c)}e.innerHTML=c}},update:function(){Q("pforex").forEach(Pforex.render);Q("[data-pforex-price]").forEach(Pforex.render);Q("select[pforex-selector]").forEach(function(e){e.value=Pforex.current})},mkSelector:function(){Q("select[pforex-selector]").forEach(function(e){e.onchange=function(e){Pforex.set(e.target.value)}})},set:function(e){if(Pforex.currencies[e]!==undefined){Pforex.current=e}else{console.log("Attempting to set unknown currency:",e)}Cookies.set("pforex",Pforex.current);Pforex.update()},get:function(){return Pforex.current},data:function(cb,err){var xhr=new XMLHttpRequest;xhr.open("GET","//cdn.shopify.com/s/javascripts/currencies.js");xhr.onload=function(){if(xhr.status===200){eval(xhr.responseText);Pforex.rates=Currency.rates;return cb?cb():false}else{console.log("Pforex could not load currency data:",xhr);return err?err():false}};xhr.send()},separate:function(e,t){function r(e){var r=e.toString().split(".");r[0]=r[0].replace(/\B(?=(\d{3})+(?!\d))/g,t.thousandSep);return r.join(t.decimalSep)}return r(e)},currencies:{USD:{symbol:"$",decimals:2,thousandSep:",",decimalSep:"."},CAD:{symbol:"$",decimals:2,thousandSep:",",decimalSep:"."},EUR:{symbol:"&euro;",decimals:2,thousandSep:",",decimalSep:"."},AUD:{symbol:"$",decimals:2,thousandSep:" ",decimalSep:"."},NZD:{symbol:"$",decimals:2,thousandSep:",",decimalSep:"."},JPY:{symbol:"&#165;",decimals:0,thousandSep:",",decimalSep:"."},GBP:{symbol:"&pound;",decimals:2,thousandSep:",",decimalSep:"."},INR:{symbol:"₹",decimals:2,thousandSep:",",decimalSep:"."},SGD:{symbol:"$",decimals:2,thousandSep:",",decimalSep:"."},MYR:{symbol:"RM",decimals:2,thousandSep:",",decimalSep:"."},SAR:{symbol:"﷼",decimals:2,thousandSep:",",decimalSep:"."},AED:{symbol:"د.إ",decimals:2,thousandSep:",",decimalSep:"."},SEK:{symbol:"kr",decimals:2,thousandSep:" ",decimalSep:","},NOK:{symbol:"kr",decimals:2,thousandSep:".",decimalSep:","},DKK:{symbol:"kr",decimals:2,thousandSep:".",decimalSep:","},CLP:{symbol:"$",decimals:0,thousandSep:".",decimalSep:"."},MXN:{symbol:"$",decimals:2,thousandSep:",",decimalSep:"."},BRL:{symbol:"$",decimals:2,thousandSep:".",decimalSep:","}}};(function(e,t){"use strict";var r=function(e){if(typeof e.document!=="object"){throw new Error("Cookies.js requires a `window` with a `document` object")}var r=function(e,t,o){return arguments.length===1?r.get(e):r.set(e,t,o)};r._document=e.document;r._cacheKeyPrefix="cookey.";r._maxExpireDate=new Date("Fri, 31 Dec 9999 23:59:59 UTC");r.defaults={path:"/",secure:false};r.get=function(e){if(r._cachedDocumentCookie!==r._document.cookie){r._renewCache()}var o=r._cache[r._cacheKeyPrefix+e];return o===t?t:decodeURIComponent(o)};r.set=function(e,o,n){n=r._getExtendedOptions(n);n.expires=r._getExpiresDate(o===t?-1:n.expires);r._document.cookie=r._generateCookieString(e,o,n);return r};r.expire=function(e,o){return r.set(e,t,o)};r._getExtendedOptions=function(e){return{path:e&&e.path||r.defaults.path,domain:e&&e.domain||r.defaults.domain,expires:e&&e.expires||r.defaults.expires,secure:e&&e.secure!==t?e.secure:r.defaults.secure}};r._isValidDate=function(e){return Object.prototype.toString.call(e)==="[object Date]"&&!isNaN(e.getTime())};r._getExpiresDate=function(e,t){t=t||new Date;if(typeof e==="number"){e=e===Infinity?r._maxExpireDate:new Date(t.getTime()+e*1e3)}else if(typeof e==="string"){e=new Date(e)}if(e&&!r._isValidDate(e)){throw new Error("`expires` parameter cannot be converted to a valid Date instance")}return e};r._generateCookieString=function(e,t,r){e=e.replace(/[^#$&+\^`|]/g,encodeURIComponent);e=e.replace(/\(/g,"%28").replace(/\)/g,"%29");t=(t+"").replace(/[^!#$&-+\--:<-\[\]-~]/g,encodeURIComponent);r=r||{};var o=e+"="+t;o+=r.path?";path="+r.path:"";o+=r.domain?";domain="+r.domain:"";o+=r.expires?";expires="+r.expires.toUTCString():"";o+=r.secure?";secure":"";return o};r._getCacheFromString=function(e){var o={};var n=e?e.split("; "):[];for(var a=0;a<n.length;a++){var c=r._getKeyValuePairFromCookieString(n[a]);if(o[r._cacheKeyPrefix+c.key]===t){o[r._cacheKeyPrefix+c.key]=c.value}}return o};r._getKeyValuePairFromCookieString=function(e){var t=e.indexOf("=");t=t<0?e.length:t;var r=e.substr(0,t);var o;try{o=decodeURIComponent(r)}catch(e){if(console&&typeof console.error==="function"){console.error('Could not decode cookie with key "'+r+'"',e)}}return{key:o,value:e.substr(t+1)}};r._renewCache=function(){r._cache=r._getCacheFromString(r._document.cookie);r._cachedDocumentCookie=r._document.cookie};r._areEnabled=function(){var e="cookies.js";var t=r.set(e,1).get(e)==="1";r.expire(e);return t};r.enabled=r._areEnabled();return r};var o=e&&typeof e.document==="object"?r(e):r;if(typeof define==="function"&&define.amd){define(function(){return o})}else if(typeof exports==="object"){if(typeof module==="object"&&typeof module.exports==="object"){exports=module.exports=o}exports.Cookies=o}else{e.Cookies=o}})(typeof window==="undefined"?this:window);Pforex.init();
